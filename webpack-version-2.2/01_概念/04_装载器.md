[装载器](https://webpack.js.org/concepts/loaders/)

# 装载器

装载器是一个资源文件转换器。它的作用是将资源文件作为参数处理并返回新的资源。

## 例子

例如，你可以用装载器载入一个CSS文件或者将TypeScript转换为JavaScript。首先安装相应的装载器。

```
npm install -D css-loader
npm install -D ts-loader
```

接着，在你的_webpack.config.js_中配置。为css文件配置`css-loader`，同理，为ts文件配置`ts-loader`。

**webpack.config.js**

```
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: 'css-loader'
      },
      {
        test: /\.ts$/,
        use: 'ts-loader'
      }
    ]
  }
};
```

*注：* 通过配置选项，一下配置定义相同的装载器用法：

```
{test: /\.css$/, loader: 'css-loader'}
// or equivalently
{test: /\.css$/, use: 'css-loader'}
// or equivalently
{test: /\.css$/, use: {
loader: 'css-loader',
options: {}
}}
```

## 配置

有三种方式使用装载器。

- 通过webpack配置
- 使用`require`语法显示使用
- 通过cli

### 通过`webpack.config.js`

[`module.rules`](https://webpack.js.org/configuration/module/#module-rules)允许你在配置中指定几种装载器。这是一种使用装载器的简单方法，并且有助于维持代码的简洁性。它也提供了每一个装载器的完整概述。

```
module: {
  rules: [
    {
      test: /\.css$/,
      use: [
        { loader: 'style-loader'},
        {
          loader: 'css-loader',
          options: {
            modules: true
          }
        }
      ]
    }
  ]
}
```

### 通过`require`

可以通过`require`方法指定装载器（或者是`define`、`require.ensure` 或者 或者其它方式）。使用`!`分离装载器与资源。每一部分都相对于当前目录进行处理。

```
require('style-loader!css-loader?modules!./styles.css');
```

可以通过前缀的`!`规则来覆盖任何一个配置中的加载器。

选项可以通过查询参数（类似web中的`?key=value&foo=bar`）。参数也可以是JSON字符串。（`?{"key":"value","foo":"bar"}`）

### 通过CLI

可选。你也可以通过CLI使用装载器。

```
webpack --module-bind jade-loader --module-bind 'css=style-loader!css-loader'
```

这里使用了`jade-loader`编译`.jade`文件，使用`style-loader`和`css-loader`编译`.css`文件。

### 装载器特征

- _装载器可以是链式的。_使用管道技术处理资源。链式的装载器按时间顺序编译。在链式装载器中的第一个装载器返回值到下一个装载器。到了最后一个装载器时，webpack期望返回的是JavaScript。
- _装载器可以是同步的或者异步的。_
- _装载器接受查询参数。_这可以通过配置项设置。
- _装载器也可以通过`option`参数来配置。_
- _除了通过`package.json`的`loader`字段的`main`以外，普通模块也可以导出一个装载器。_
- _插件可以给装载器更多的特性。_
- _装载器可以处理任意文件。_

在JavaScript生态系统中，装载器可以通过预处理方法实现更多的功能。用户可以更加灵活的包含细颗粒度的逻辑，例如压缩，打包，语言转换以及更多功能。

## 分解模块

装载器遵循标准的[模块分解](https://webpack.js.org/concepts/module-resolution/)。在大部分例子里，你通过[模块路径](https://webpack.js.org/concepts/module-resolution/#module-paths)来进行装载。（`npm install` `node_modules`）。

[如何写一个模块？](https://webpack.js.org/development/how-to-write-a-loader)一个装载模块期望实现一个的功能。在通常情况下，你管理装载器通过npm，但是你也可以自己编写loader模块。

根据规定，装载器通常被命名为`XXX-loader`。`XXX`是你的上下文名字。例如，`json-loader`。

装载器的名字公约和预先搜索顺序是通过webpack配置中的[`resolveLoader.moduleTemplates`](https://webpack.js.org/configuration/resolve#resolveloader)属性定义的。
